<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="layui/css/layui.css" media="all" />
    <link rel="stylesheet" href="css/style.css" />
    <title>账号-打招呼模板2</title>
  </head>

  <body class="layui-layout-body">
    <div class="layui-layout layui-layout-admin">
      <div class="layui-header">
        <div class="layui-logo">
          <img src="images/logo.png" alt="" class="img" />
        </div>
        <div class="head_right clearfix">
          <div class="top_notice fl">
            <span class="fz">打招呼模板列表</span>
            <div class="txt">
              <li>这里是功能介绍这里是功能介绍这里是功能介绍</li>
            </div>
          </div>
          <!--<div class="top_wz fl">
                <em class="c_blue">567</em>（总使用）/ <em class="c_blue">2000</em>（总端口数）
            </div>-->
          <div class="fr">
            <a href="#" class="r_fz c_blue">查看登陆日志</a>
            <span class="r_fz">xdqy</span>
            <a href="#" class="r_fz c_blue">修改密码</a>
            <span class="quit quits">退出</span>
          </div>
        </div>
      </div>
      <div class="layui-side left_menu_side">
        <div class="layui-side-scroll">
          <ul class="left_menu">
            <li class="item index">
              <a href="#">首页</a>
            </li>
            <li class="item account haschild cur">
              <a href="#">账号</a>
              <div class="drop">
                <a href="账号-会员管理.html">分组管理</a>
                <a href="账号-账号管理.html">账号管理</a>
                <a href="账号-账号设置.html">账号设置</a>
              </div>
            </li>
            <li class="item friend haschild">
              <a href="#">好友</a>
              <div class="drop">
                <a href="好友管理.html">好友管理</a>
                <a href="好友-加粉任务.html">加粉任务</a>
                <a href="好友分析.html">好友分析</a>
              </div>
            </li>
            <li class="item group haschild">
              <a href="#">群</a>
              <div class="drop">
                <a href="群管-拉群任务.html">批量拉群</a>
                <a href="群管-新建群聊.html">自动群聊</a>
              </div>
            </li>
            <li class="item function haschild">
              <a href="#">功能</a>
              <div class="drop">
                <a href="功能-群发消息.html">群发消息</a>
                <a href="功能-发朋友圈.html">群发朋友圈</a>
                <a href="功能-朋友圈评论.html">朋友圈评论</a>
                <a href="功能-素材管理.html">素材管理</a>
                <a href="#">群发群</a>
              </div>
            </li>
            <li class="item customer haschild">
              <a href="#">客服系统</a>
              <div class="drop">
                <a href="客服-客服管理.html">客服管理</a>
                <a href="客服-聊天设置.html">聊天设置</a>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="layui-body">
        <div class="">
          <div class="friend_bar clearfix layui-form">
            <div class="searchbox fl">
              <input
                type="text"
                class="ipt ipt_txt searchkj"
                placeholder="请输入模板名称"
              />
            </div>
            <button class="button_ico add fr">添加打招呼模板</button>
          </div>
          <div class="friend_tablewrap">
            <table class="friend_table layui-form">
              <thead>
                <th width="10%">序号</th>
                <th width="30%">模板名称</th>
                <!-- <th width="20%">状态</th> -->
                <th width="20%">操作</th>
              </thead>
              <tbody>
                <!-- <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="c_blue">开启</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="">关闭</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="c_blue">开启</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="">关闭</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="c_blue">开启</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="">关闭</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="c_blue">开启</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>好了，好了，我知道了</td>
                  <td><em class="">关闭</em></td>

                  <td>
                    <a href="javascript:;" class="lk_ico edit">编辑</a>
                    <a href="javascript:;" class="lk_ico delete">删除</a>
                  </td>
                </tr> -->
              </tbody>
            </table>
            <div class="pagelist_wrap">
              <span class="fz">共144条记录，每页显示</span>
              <select name="" id="" class="num_box">
                <option value="">10</option>
                <option value="">20</option>
                <option value="">30</option>
                <option value="">40</option>
              </select>
              <div class="pagelist" id="Page"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="layui/layui.js" charset="utf-8"></script>
    <script src="js/common.js" charset="utf-8"></script>
    <script src="js/loginout.js"></script>
    <script>
      layui.use(['form', 'upload', 'laydate'], function() {
        var form = layui.form,
          layer = layui.layer,
          layedit = layui.layedit,
          laydate = layui.laydate,
          upload = layui.upload

        //搜索快捷语名称
        $('body').delegate('.searchkj', 'propertychange input', function() {
          console.log($(this).val())
        })

        //获取好友模板
        token = localStorage.getItem('token')
        var data =
          '{"type":' +
          '"get_add_auto_send_template",' +
          '"ticket":' +
          '"' +
          token +
          '"' +
          '}'
        //传入参数
        //console.log(data)
        $.ajax({
          type: 'post',
          url: 'http://192.168.10.177/api.esp',
          data: data,
          dataType: 'json',
          success: function(msg) {
            if (msg.err_code == 0) {
              var data = msg.data
              var str = ''
              var ind = 0
              for (var i in data) {
                console.log(typeof data[i])
                ind++
                ind = ind < 10 ? '0' + ind : ind
                str += `
                <tr>
                  <td>${ind}</td>
                  <td>${data[i].content}</td>

                  <td>
                    <a href="javascript:;" class="lk_ico delete" data-id=${
                      data[i].id
                    }>删除</a>
                  </td>
                </tr>
                `
              }
              $('tbody').append(str)
            }
          },
          error: function(err) {
            console.log(err)
          }
        })

        //删除通过好友自动回复
        $('body').delegate('.delete', 'click', function() {
          var $id = $(this)
            .get(0)
            .getAttribute('data-id')

          var data =
            '{"type":' +
            '"del_add_auto_send_template",' +
            '"id":' +
            '"' +
            $id +
            '",' +
            '"ticket":' +
            '"' +
            token +
            '"' +
            '}'
          //传入参数
          //console.log(data)
          $.ajax({
            type: 'post',
            url: 'http://192.168.10.177/api.esp',
            data: data,
            dataType: 'json',
            success: function(msg) {
              console.log(msg)
              if (msg.err_code == 0) {
                layer.msg('删除成功')
                location.reload()
              } else {
                layer.msg('删除成功')
                location.reload()
              }
            },
            error: function(err) {
              console.log(err)
            }
          })
        })

        form.on('checkbox(allChoose)', function(data) {
          var child = $(data.elem)
            .parents('table')
            .find('tbody input[type="checkbox"]')
          child.each(function(index, item) {
            item.checked = data.elem.checked
          })
          form.render('checkbox')
        })
        form.on('checkbox(itemChoose)', function(data) {
          var sib = $(data.elem)
            .parents('table')
            .find('tbody input[type="checkbox"]:checked').length
          var total = $(data.elem)
            .parents('table')
            .find('tbody input[type="checkbox"]').length
          if (sib == total) {
            $(data.elem)
              .parents('table')
              .find('thead input[type="checkbox"]')
              .prop('checked', true)
            form.render()
          } else {
            $(data.elem)
              .parents('table')
              .find('thead input[type="checkbox"]')
              .prop('checked', false)
            form.render()
          }
        })

        $('.add').click(function() {
          location.href = '账号-打招呼模板.html'
        })
      })
    </script>
    <script type="text/javascript" src="js/mypage.js"></script>
    <script type="text/javascript">
      P.initMathod({
        params: { elemId: '#Page', total: '123' },
        requestFunction: function() {
          // P.config.total = parseInt(Math.random() * 10 + 85);//此处模拟总记录变化

          //TODO ajax异步请求过程,异步获取到的数据总条数赋值给 P.config.total

          //列表渲染自行处理

          console.log(JSON.stringify(P.config))
        }
      })
    </script>
  </body>
</html>
